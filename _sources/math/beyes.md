# ベイズの定理

条件付き確率
: ある事象Aの下で事象Bが起きる確率

$$
P(B|A) = \dfrac{P(A \cap B)}{P(A)}
$$

乗法定理
: 条件付き確率の式を変形したもの

$$
P(A \cap B) = P(B) \times P(A|B)\\
P(A \cap B) = P(A) \times P(B|A)
$$

ベイズの定理
: 条件付き確率の式に乗法定理を代入したもの

$$
P(A|B)=\dfrac{P(B|A)P(A)}{P(B)}
$$

with 変形

$$
P(B|A)=\dfrac{P(A\cap B)}{P(A)}
=\dfrac{P(B) P(A|B)}{P(A)}\\
P(A|B)=\dfrac{P(A\cap B)}{P(B)}=\dfrac{P(A)P(B|A)}{P(B)}\\
$$

## 独立事象との条件付き確率下の全事象の計算
事象Aが起こる条件の元でk種類の独立事象Bがあるとすると、事象Aの起こる確率は

$$
P(A)=P(A\cap B_1)+P(A\cap B_2)+P(A\cap B_3)+\cdots+P(A\cap B_k)
$$

すなわち、

$$
P(A)=\sum_{i=1}^k P(A\cap B_k)
$$

とも書ける

事後確率
: $P(A)$に対して、Bという情報を得たと考えられるので、
- $P(A)$を事前確率
- $P(A|B)$を事後確率
とも呼ぶ

## 練習問題

>5回に1回の割合で帽子を忘れるくせのあるK君が正月に A，B，C の3軒を順に訪問して家に帰ったとき，帽子を忘れてきたことに気がついた。2軒目の家 B に忘れてきた確率を求めよ。
> -- [高校数学の美しい物語](https://manabitimes.jp/math/804)

- 事象E: 帽子を忘れる
- 事象A、B、C：それぞれの家に行く
- 求める確率: $P(\overline{A})P(B)$

$$
P(A) = \dfrac{1}{5}\\
P(B) = \dfrac{1}{4}\\
Aでは忘れず、Bで忘れた確率は、\\
P = (1-P(A))\times P(B)\\
=\dfrac{4}{5}\times \dfrac{1}{4}\\
=\dfrac{1}{4}
$$

> 1から3の目が赤色で塗られており、4から6の目は青色で塗られているさいころがある。  
今、このさいころを投げて青色の目が出た時、この目が偶数である確率を求めよ。  
> --[統計web](https://bellcurve.jp/statistics/course/7873.html)

- 事象A: サイコロの目が偶数
- 事象B: サイコロの目が青色
- 求める確率: $P(A|B) = \dfrac{P(A \cap B)}{P(B)}$

事象$B$は出目が青色のケースなので、該当する出目は4, 5, 6の3通り。全事象$U$は6通りなので、

$$
P(B) = \dfrac{|B|}{|U|} = \dfrac{3}{6}
$$

事象$A \cap B$は、青色かつ偶数なので出目は4,6の2通り

$$
P(A \cap B) = \dfrac{2}{6}\\

\therefore P(A|B) = \dfrac{P(A \cap B)}{P(B)}\\
= \dfrac{2}{3}
$$

> 表と裏の面が赤か青で塗られている3枚のカードA, B, Cがあり、それぞれのカードの面の色は次のようになっている。
>
>- カードA：両面とも青色で塗られている
>- カードB：片面が赤色、もう片面が青色で塗られている
>- カードC：両面とも赤色で塗られている。
>
>このカード3枚を袋に入れてよく混ぜて、目をつぶったまま1枚を取り出し、机の上に置いて目を開けるとカードは赤色だった。このとき、ひっくり返した面も赤色である確率を求めよ。  
> --[統計web](https://bellcurve.jp/statistics/course/7873.html)

- 事象A: カードが赤色
- 事象B: 裏面も赤色
- 求める確率: $P(B|A) = \dfrac{P(A \cap B)}{P(A)}$

事象$A$は3枚のカードのうち、選んだカードの表面が赤色のケース。

選んだカード|A表|A裏|B表|B裏|C表|C裏
-|-|-|-|-|-|-
事象$A$|-|-|〇|-|〇|〇
事象$B$|-|-|-|〇|〇|〇

$$
P(A)=\dfrac{3}{6}\\
P(A \cap B) = \dfrac{2}{6}\\
P(B|A) = \dfrac{2}{3}
$$

> 一郎、二郎、三郎、四郎の4人がボウリングでストライクを出す確率は50%, 70%, 90%, 98%である。4人のうち1人が球を投げてストライクを出したときに、それが一郎である確率はいくらか。  
> --[統計web](https://bellcurve.jp/statistics/course/7873.html)

- 事象A: 4人のうち一人がストライクを出す
- 事象B: それが一郎である
- 求める確率: $P(B|A) = \dfrac{P(A \cap B)}{P(A)}$

$$
P(A \cap B) = \dfrac{1}{4} \times \dfrac{50}{100}\\
P(A) = \dfrac{1}{4} \times \dfrac{50+70+90+98}{100}\\
= \dfrac{1}{4} \times \dfrac{308}{100}\\
P(B|A) = \dfrac{50}{308}=\dfrac{25}{154}\\
\fallingdotseq 0.16\\

確率は16\%
$$

> ある映画の試写会を行い、満足度のアンケート調査を行った。試写会に参加したのは300人でそのうち女性が180人であり、満足したと回答したのは男性の50％、女性の75％であった。この映画を見て満足しなかったと答えた人が女性である確率はいくらか。

- 事象A: 満足しなかった
- 事象B: 回答者は女性
- 求める確率: $P(B|A)=\dfrac{P(A \cap B)}{P(A)}$

-|満足|不満足|計
-|-|-|-
男性|50%|50%|120人
女性|75%|25%|180人

$P(A \cap B)$は不満足かつ女性なので、

$$
P(A \cap B) =　\dfrac{180人 \times 0.25}{300人}\\
= \dfrac{45}{300}\\
P(A) = \dfrac{120\times 0.5 + 180 \times 0.25}{300}\\
= \dfrac{105}{300}\\
P(A|B) = \dfrac{45}{105}\\
\fallingdotseq 0.4285\\
割合は42\%
$$

> 人の「疲れ」を判定する機械が発明された。この機械に人が入ると「疲れている」か「疲れていない」かを判定してくれる画期的なものである。この機械を使うと、疲れている人の95％を「疲れている」と判定し、疲れていない人の98％を「疲れていない」と判定するということが分かっている。
>
>人の70%は疲れているという研究結果があるとき、ある人がこの機械に入って「疲れている」と判定された場合に実際に疲れている確率はいくらか。（すべて架空の話です）

- 事象A: 疲れている判定
- 事象B: 実際に疲れている
- 求める確率: $P(B|A)=\dfrac{P(A \cap B)}{P(A)}$

事象$A$には「実際に疲れている人」の95%＋「疲れていない人」の2%が該当するので、

$$
P(A) = \dfrac{70}{100} \times \dfrac{95}{100} + \dfrac{30}{100} \times \dfrac{2}{100}\\
= \dfrac{6650+60}{10000}
= \dfrac{671}{1000}
$$

事象$A \cap B$は「疲れている判定された」かつ「実際に疲れている人」のケースなので、

$$
P(A \cap B) = \dfrac{95}{100} \times \dfrac{70}{100}\\
= \dfrac{665}{1000}\\

P(B|A) = \dfrac{665}{671}\\
= 0.9910581222056632\\
確率は約99.1%
$$

